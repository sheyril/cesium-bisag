<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="utf-8">
    <title>JSDoc: Module: layerProcessing</title>

    <script src="scripts/prettify/prettify.js"> </script>
    <script src="scripts/prettify/lang-css.js"> </script>
    <!--[if lt IE 9]>
      <script src="//html5shiv.googlecode.com/svn/trunk/html5.js"></script>
    <![endif]-->
    <link type="text/css" rel="stylesheet" href="styles/prettify-tomorrow.css">
    <link type="text/css" rel="stylesheet" href="styles/jsdoc-default.css">
</head>

<body>

<div id="main">

    <h1 class="page-title">Module: layerProcessing</h1>

    




<section>

<header>
    
        
            
        
    
</header>

<article>
    <div class="container-overview">
    
        
            <div class="description">This module contains varius functions to process and prepare data for rendering on Cesium and publishing to geoserver</div>
        

        
            















<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line1">line 1</a>
    </li></ul></dd>
    

    

    

    
</dl>




















        
    
    </div>

    

    

    

    

    

    

    

    
        <h3 class="subsection-title">Methods</h3>

        
            

    

    
    <h4 class="name" id="~addTiledContoursToExistingTable"><span class="type-signature">(async, inner) </span>addTiledContoursToExistingTable<span class="signature">(jsonLayerFile, geoserverConnectionObj)</span><span class="type-signature"> &rarr; {Promise.&lt;null>}</span></h4>
    

    



<div class="description">
    Creates tiled contours. Adds them to the existing meta tables that were created initially using prepareTiledContours. Use this function if you want to insert more tiles under some layer that has already some vector tiles
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerFile</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Path to the configuration JSON file which contains daa on the layer</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>geoserverConnectionObj</code></td>
            

            <td class="type">
            
                
<span class="param-type">geoserverConnection</span>


            
            </td>

            

            

            <td class="description last">Instance of the geoserver connection</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line34">line 34</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns a promise when the tiled vectors have been all published to geoserver
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;null></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~checkRowsOfEachTileAndTrim"><span class="type-signature">(async, inner) </span>checkRowsOfEachTileAndTrim<span class="signature">(jsonLayerObject, tableInfoJsonObject, geoObject)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Helper function to prepareTiledContours and addTiledContoursToExistingTable
Checks the meta table to drop all the redundant tables that were created with FeatureCount=0
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">object resulted from parsing the configuration JSON file</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tableInfoJsonObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">tableInfoJsonObject</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>geoObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">geoserverConnection</span>


            
            </td>

            

            

            <td class="description last">Instance of geoserver connection to use</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line287">line 287</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


    





        
            

    

    
    <h4 class="name" id="~createMetaTable"><span class="type-signature">(async, inner) </span>createMetaTable<span class="signature">(jsonLayerObject, geoserverConnectionObj)</span><span class="type-signature"> &rarr; {Promise.&lt;{jsonLayerObject: Object, sqlOutput: {stdout: string, stderr: string}}>}</span></h4>
    

    



<div class="description">
    Helper function to prepareTiledContours and addTiledContoursToExistingTable
Creates all necessary meta tables for tiled vectors
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">object resulted from parsing the configuration JSON file</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>geoserverConnectionObj</code></td>
            

            <td class="type">
            
                
<span class="param-type">geoserverConnection</span>


            
            </td>

            

            

            <td class="description last">Instance of geoserver connection to use</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line357">line 357</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns a promise that is resolved when all the meta tables are created successfully
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;{jsonLayerObject: Object, sqlOutput: {stdout: string, stderr: string}}></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~deleteFileFromSystem"><span class="type-signature">(inner) </span>deleteFileFromSystem<span class="signature">(filepath)</span><span class="type-signature"> &rarr; {Promise.&lt;{outpath: string}>}</span></h4>
    

    



<div class="description">
    Delete a file from system asynchronously
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>filepath</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Path to the file to be deleted</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line418">line 418</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns a promise that resolves when the file is deleted successfully
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;{outpath: string}></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~deleteTiledContours"><span class="type-signature">(async, inner) </span>deleteTiledContours<span class="signature">(jsonLayerFile, geoObject)</span><span class="type-signature"> &rarr; {Promise.&lt;null>}</span></h4>
    

    



<div class="description">
    Deletes the tiled contours from geoserver and PostGIS. The data is lost. Be careful with this function
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerFile</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">The path to layer configuration JSON file used</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>geoObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">geoserverConnection</span>


            
            </td>

            

            

            <td class="description last">Instance of geoserverConnection to be used</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line209">line 209</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns a promise that resolves if the tiled contours were deleted successfully
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;null></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~deleteVectorFromSystem"><span class="type-signature">(inner) </span>deleteVectorFromSystem<span class="signature">(filepath)</span><span class="type-signature"> &rarr; {Promise.&lt;null>}</span></h4>
    

    



<div class="description">
    deletes a shapefile and its associated files from system
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>filepath</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Path of the shapefile to be deleted</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line434">line 434</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns a promise that is resolved when the files are deleted successfully
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;null></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~PrepareInsertionsForMetaTable"><span class="type-signature">(inner) </span>PrepareInsertionsForMetaTable<span class="signature">(jsonLayerFile)</span><span class="type-signature"> &rarr; {Promise.&lt;{jsonLayerObject: Object, filepath: string, tableInfoJsonObject: tableInfoJsonObject}>}</span></h4>
    

    



<div class="description">
    Helper function to prepareTiledContours and addTiledContoursToExistingTable
Creates a file which has the SQL commands to insert tiled contours meta data in the meta table
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerFile</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Path to the the layer configuration file</td>
        </tr>

    
    </tbody>
</table>






    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">The object resulted from parsing the layer configuration JSON File</td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line236">line 236</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns a promise that is resolved if the insertion commands were written successfully. filepath is the path of the file that has the commands
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;{jsonLayerObject: Object, filepath: string, tableInfoJsonObject: tableInfoJsonObject}></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~prepareTiledContours"><span class="type-signature">(async, inner) </span>prepareTiledContours<span class="signature">(jsonLayerFile, geoObject, db)</span><span class="type-signature"> &rarr; {Promise.&lt;null>}</span></h4>
    

    



<div class="description">
    Tiles a vector. Creates a new schema in PostGIS with name same as layerName in configuration file. Creates a new namespace and datastore in geoserver with name same as layerName in the configuration file. Creates all necessary meta tables.
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerFile</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">path to configuration JSON file used to define the layer</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>geoObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">geoserverConnection</span>


            
            </td>

            

            

            <td class="description last">instance of geoserverConnection</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>db</code></td>
            

            <td class="type">
            
                
<span class="param-type">database</span>


            
            </td>

            

            

            <td class="description last">instance of database to be used</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line70">line 70</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - A promise that is resolved if the tiled contours were generated and published successfully
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;null></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~publishContourAfterGenerating"><span class="type-signature">(inner) </span>publishContourAfterGenerating<span class="signature">(filename, bands, interval, geoserverConnectionObj)</span><span class="type-signature"> &rarr; {Promise.&lt;{vectorPath: string, rasterPath: string}>}</span></h4>
    

    



<div class="description">
    Dynamically generates a contour after making a WMS request. Has been changed a bit because of getMapWMS. Check that function
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>filename</code></td>
            

            <td class="type">
            
                
<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">Name of the raster layer from which contour has to be generated</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>bands</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>
|

<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">number of bands of the layer</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>interval</code></td>
            

            <td class="type">
            
                
<span class="param-type">number</span>
|

<span class="param-type">string</span>


            
            </td>

            

            

            <td class="description last">intervals to used for contours</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>geoserverConnectionObj</code></td>
            

            <td class="type">
            
                
<span class="param-type">geoserverConnection</span>


            
            </td>

            

            

            <td class="description last">Instance of geoserverConnection to be used</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line389">line 389</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        
<div class="param-desc">
    - Returns a promise that is resolved when the contours are generated successfully
</div>



<dl>
    <dt>
        Type
    </dt>
    <dd>
        
<span class="param-type">Promise.&lt;{vectorPath: string, rasterPath: string}></span>


    </dd>
</dl>

    





        
            

    

    
    <h4 class="name" id="~publishTiledContours"><span class="type-signature">(async, inner) </span>publishTiledContours<span class="signature">(jsonLayerObject, tableInfoJsonObject, geoserverConnectionObj)</span><span class="type-signature"></span></h4>
    

    



<div class="description">
    Helper function to prepareTiledContours and addTiledContoursToExistingTable
Publishes all the generated tiled contours from PostGIS datastore
</div>









    <h5>Parameters:</h5>
    

<table class="params">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>jsonLayerObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">Object</span>


            
            </td>

            

            

            <td class="description last">object resulted from parsing the configuration JSON file</td>
        </tr>

    

        <tr>
            
                <td class="name"><code>tableInfoJsonObject</code></td>
            

            <td class="type">
            
                
<span class="param-type">tableInfoJsonObject</span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    

        <tr>
            
                <td class="name"><code>geoserverConnectionObj</code></td>
            

            <td class="type">
            
                
<span class="param-type">geoserverConnection</span>


            
            </td>

            

            

            <td class="description last">Instance of geoserver connection to use</td>
        </tr>

    
    </tbody>
</table>






<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line330">line 330</a>
    </li></ul></dd>
    

    

    

    
</dl>















<h5>Returns:</h5>

        


    





        
    

    
        <h3 class="subsection-title">Type Definitions</h3>

        
                
<h4 class="name" id="~tableInfoJsonObject">tableInfoJsonObject</h4>




<div class="description">
    The Object containing information about name of the layer to be inserted in meta table and the path to the layer to beinserted with that name
</div>



    <h5>Type:</h5>
    <ul>
        <li>
            
<span class="param-type">Object</span>


        </li>
    </ul>





    <h5 class="subsection-title">Properties:</h5>

    

<table class="props">
    <thead>
    <tr>
        
        <th>Name</th>
        

        <th>Type</th>

        

        

        <th class="last">Description</th>
    </tr>
    </thead>

    <tbody>
    

        <tr>
            
                <td class="name"><code>layers</code></td>
            

            <td class="type">
            
                
<span class="param-type">array.&lt;{layerName: string, filePath: string}></span>


            
            </td>

            

            

            <td class="description last"></td>
        </tr>

    
    </tbody>
</table>




<dl class="details">

    

    

    

    

    

    

    

    

    

    

    

    

    
    <dt class="tag-source">Source:</dt>
    <dd class="tag-source"><ul class="dummy"><li>
        <a href="layerProcessing.js.html">layerProcessing.js</a>, <a href="layerProcessing.js.html#line224">line 224</a>
    </li></ul></dd>
    

    

    

    
</dl>






            
    

    
</article>

</section>




</div>

<nav>
    <h2><a href="index.html">Home</a></h2><h3>Modules</h3><ul><li><a href="module-convention.html">convention</a></li><li><a href="module-geoserverRequests.html">geoserverRequests</a></li><li><a href="module-layerProcessing.html">layerProcessing</a></li><li><a href="module-postGisOperations.html">postGisOperations</a></li><li><a href="module-useCommandLine.html">useCommandLine</a></li></ul><h3>Classes</h3><ul><li><a href="module-geoserverRequests-geoserverConnection.html">geoserverConnection</a></li><li><a href="module-postGisOperations-database.html">database</a></li><li><a href="module-postGisOperations-schema.html">schema</a></li></ul>
</nav>

<br class="clear">

<footer>
    Documentation generated by <a href="https://github.com/jsdoc/jsdoc">JSDoc 3.6.2</a> on Mon Jul 08 2019 01:10:40 GMT+0530 (India Standard Time)
</footer>

<script> prettyPrint(); </script>
<script src="scripts/linenumber.js"> </script>
</body>
</html>